<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Room Layout Tester - Virtual Clue Game</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="test-layout.css">
</head>
<body>
    <h1>üõ†Ô∏è Interactive Room Layout Tester</h1>
    
    <div class="info">
        <p><strong>Advanced Room Layout Testing Tool</strong></p>
        <p>Adjust room positions, doors, and starting positions with real-time visual feedback.</p>
        <p>Click on tiles to quickly position rooms, or use the detailed controls below.</p>
    </div>

    <div class="status-info" id="status-info">
        Ready to edit board layout. Select a room or element to start.
    </div>

    <!-- Control Panel will be inserted here by JavaScript -->

    <div class="board-container">
        <div class="classic-clue-board" id="clue-board">
            <!-- Board will be generated by JavaScript -->
        </div>
    </div>

    <div class="coordinates-display" id="coordinates-display">
        Mouse: (0, 0)
    </div>

    <div class="config-display">
        <div class="config-header">
            <h3>üîß Live JSON Configuration Editor</h3>
            <div id="json-status" class="json-status">Ready to edit</div>
        </div>
        <div class="config-help">
            <p><strong>Live Edit Mode:</strong> Edit the JSON below and changes will be validated in real-time. Click "Apply JSON Changes" to update the board.</p>
        </div>
        <textarea id="config-editor" placeholder="Configuration will load here..." spellcheck="false"></textarea>
    </div>

    <div class="back-link">
        <a href="../index.html">‚Üê Back to Game</a> | 
        <a href="test-room-layout.html">‚Üê Simple Layout View</a>
    </div>

    <script src="test-layout.js"></script>
    <script>
        // Add mouse tracking for coordinates
        document.addEventListener('mousemove', (e) => {
            const board = document.getElementById('clue-board');
            if (board) {
                const rect = board.getBoundingClientRect();
                const x = Math.floor((e.clientX - rect.left - 10) / 21); // Account for padding and tile size
                const y = Math.floor((e.clientY - rect.top - 10) / 21);
                
                if (x >= 0 && x < 25 && y >= 0 && y < 25) {
                    document.getElementById('coordinates-display').innerHTML = `
                        Mouse: (${y}, ${x})<br>
                        Click to position
                    `;
                }
            }
        });

        // Auto-update JSON editor when changes are made through UI
        function updateJsonEditor() {
            if (window.testLayoutManager) {
                window.testLayoutManager.exportConfiguration();
            }
        }

        // Update status info
        function updateStatus(message) {
            document.getElementById('status-info').textContent = message;
        }

        // Override some methods to provide better feedback
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                if (window.testLayoutManager) {
                    const originalUpdateRoom = window.testLayoutManager.updateRoom;
                    window.testLayoutManager.updateRoom = function() {
                        originalUpdateRoom.call(this);
                        updateStatus(`Room "${this.currentRoom}" updated successfully!`);
                        updateJsonEditor();
                    };

                    const originalUpdateDoor = window.testLayoutManager.updateDoor;
                    window.testLayoutManager.updateDoor = function() {
                        originalUpdateDoor.call(this);
                        updateStatus('Door position updated successfully!');
                        updateJsonEditor();
                    };

                    const originalUpdateStart = window.testLayoutManager.updateStart;
                    window.testLayoutManager.updateStart = function() {
                        originalUpdateStart.call(this);
                        updateStatus('Starting position updated successfully!');
                        updateJsonEditor();
                    };
                }
            }, 100);
        });
    </script>
</body>
</html>